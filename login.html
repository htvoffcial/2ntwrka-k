<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0">
  <title>2組ログイン</title>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
</head>
<body>
  <div id="l-flex">
  <div id="loginbox">
    <center><small id="mmt">2組IDでログイン</small></center>
  <form id="loginform" method="POST">
    <div id="inputing">
      <label style="font-weight: bold;font-size: 20px;">2組サイト(仮)にログイン</label><br><br>
    <label for="username">ユーザ名</label><br>
    <input type="text" id="username" name="username" required><br><br>
    <label for="password">パスワード</label><br>
    <input type="password" id="password" name="password" required><br><br>
    <input type="button" value="続ける" id="camsb">
    </div>

  </form>
</div>
<div id="loadbox">
<div id="center1">認証中...</div>
</div>
</div>
  <style>
    #camsb{
      border: none;
      padding: 10px 12px 10px 12px;
      font-weight: bold;
      background: chocolate;
      border-radius: 10px;
    }
    #mmt{
      margin-top: 2px;
      font-size: 12px;
    }
    @media screen and (max-width: 480px) { 
      #l-flex{

      }
    }
    #inputing{
      transform: translateX(20%)translateY(60%);
    }
    #center1{
      font-size:small;
      transform: translateX(15vw)translateY(40vh);
    }
    #username,#password{
      margin: 10px;
    outline: 0;
    display: inline-block;
    opacity: 0.8;
    border: none;
    padding: 6px;
    border-bottom: solid 2px chocolate;
    }
    #l-flex{
      width:100%;
      height:100%;
      position: absolute;
      top:0px;
      left:0px;
      display: flexbox;
      background:url(https://ul.h3z.jp/NgB2ytzl.png);

    }

    #loginbox{
      box-shadow: 10px  0px 320px 10px gray;
      position: absolute;
      top:20px;
      left:60px;
      height:calc(100% - 20px);
      width:42%;
      background-color: aliceblue;
      border-radius:10px 10px 0px 0px;
    }
    #loadbox{
      display: none;
      box-shadow: 10px  0px 320px 10px gray;
      position: absolute;
      top:20px;
      left:60px;
      height:calc(100% - 20px);
      width:42%;
      background-color: aliceblue;
      border-radius:10px 10px 0px 0px;
      z-index:1000;
    }
  </style>
  <script>
    $(document).ready(function() {
      $('camsb').click(function() {
        document.getElementById("loadbox").style.display="block";
        var username = $("#username").val();
        var password = $("#password").val();
        localStorage.setItem("id1",username);
        // ログインリクエストを送信
        $.ajax({
          url: "https://script.google.com/macros/s/AKfycbwKiXHATrxOrYLQWPct4AIYqeFDcMO9ihhHIx5jeUOs2TZMsQGpHT_5dD8q-9o2Rzdh/exec",
          method: "POST",
          data: { 
            action: "login",
            username: username,
            password: password
          },
          success: function(response) {
            if (response === "success") {
              window.location.href = "dashboard.html"; // ログイン成功時にダッシュボードページにリダイレクト
            } else {
              alert("Invalid username or password."); // ログイン失敗時のエラーメッセージ
              document.getElementById("loadbox").style.display="none";
            }
          },
          error: function() {
            alert("An error occurred while processing your request."); // リクエストの処理中にエラーが発生した場合のエラーメッセージ
          }
        });
      });
    });
  </script>
</body>
</html>
